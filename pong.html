<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Paddle Pass</title>
  <style>
    body {
      margin: 0;
      background: #222;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
    }
    canvas {
      background: #111;
      border: 2px solid white;
      touch-action: none;
    }
    #message {
      position: absolute;
      top: 20px;
      color: white;
      font-size: 1.5em;
      font-family: sans-serif;
      width: 100%;
      text-align: center;
      z-index: 1;
    }
  </style>
</head>
<body>
  <div id="message"></div>
  <canvas id="gameCanvas" width="300" height="500"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const msg = document.getElementById("message");
  
    const paddle = {
      x: 120,
      y: 470,
      width: 60,
      height: 10,
      prevX: 120
    };
  
    const ball = {
      x: 150,
      y: 250,
      radius: 8,
      dx: 2 * (Math.random() > 0.5 ? 1 : -1),
      dy: 3 // starts going downward
    };
  
    const gapSize = 50;
    let punishmentShown = false;
  
    canvas.addEventListener("touchmove", e => {
      const touch = e.touches[0];
      const rect = canvas.getBoundingClientRect();
      const touchX = touch.clientX - rect.left;
  
      paddle.prevX = paddle.x;
      paddle.x = Math.max(0, Math.min(touchX - paddle.width / 2, canvas.width - paddle.width));
    });
  
    function drawPaddle() {
      ctx.fillStyle = "white";
      ctx.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
    }
  
    function drawBall() {
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
      ctx.fillStyle = "cyan";
      ctx.fill();
      ctx.closePath();
    }
  
    function drawGaps() {
      ctx.fillStyle = "lime";
      ctx.fillRect(0, 0, gapSize, 10); // Left
      ctx.fillRect(canvas.width - gapSize, 0, gapSize, 10); // Right
    }
  
    function showMessage(text) {
      msg.textContent = text;
    }
  
    function resetBall(message) {
      showMessage(message);
      punishmentShown = true;
      setTimeout(() => {
        ball.x = 150;
        ball.y = 250;
        ball.dx = 2 * (Math.random() > 0.5 ? 1 : -1);
        ball.dy = 3;
        punishmentShown = false;
        showMessage("");
      }, 2000);
    }
  
    function update() {
      if (punishmentShown) return;
  
      ball.x += ball.dx;
      ball.y += ball.dy;
  
      // Wall collisions
      if (ball.x - ball.radius < 0 || ball.x + ball.radius > canvas.width) ball.dx *= -1;
      if (ball.y - ball.radius < 0) ball.dy *= -1;
  
      // Paddle collision
      const paddleMoved = paddle.x - paddle.prevX;
  
      if (
        ball.y + ball.radius >= paddle.y &&
        ball.x > paddle.x &&
        ball.x < paddle.x + paddle.width &&
        ball.dy > 0
      ) {
        ball.dy *= -1;
        ball.y = paddle.y - ball.radius;
  
        // Add paddle movement influence
        ball.dx += paddleMoved * 0.1;
  
        // Clamp horizontal speed
        ball.dx = Math.max(-5, Math.min(5, ball.dx));
      }
  
      // Bottom loss
      if (ball.y - ball.radius > canvas.height) {
        resetBall("üí• You missed! Punishment time!");
      }
  
      // Top left/right goals
      if (ball.y - ball.radius <= 0) {
        if (ball.x < gapSize) {
          resetBall("‚û°Ô∏è Passed to the left!");
        } else if (ball.x > canvas.width - gapSize) {
          resetBall("‚¨ÖÔ∏è Passed to the right!");
        } else {
          ball.dy *= -1;
        }
      }
    }
  
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawBall();
      drawPaddle();
      drawGaps();
    }
  
    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }
  
    loop();
  </script>
  
</body>
</html>
